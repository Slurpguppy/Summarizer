<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Summarizer</title>
  <link rel="icon" href="imgs/newspaper-regular.png" type="image/png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&family=Open+Sans:ital,wght@0,300..800;1,300..800&family=Ubuntu:ital,wght@0,300;0,400;0,500;0,700;1,300;1,400;1,500;1,700&display=swap" rel="stylesheet">
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8986512893450250"
     crossorigin="anonymous"></script>
     <link rel="stylesheet" href="css/sliderstyles.css"> <!-- Slider css -->
     <link rel="stylesheet" href="css/mainstyles.css"> <!-- Main css -->
     <link rel="stylesheet" href="css/copystyles.css"> <!-- Side-bar css -->
     
  <style>

.locked-button:hover object,
.locked-button:hover i {
    display: none; /* Hide the original icon on hover */
}

.locked-button:hover i {
    display: inline; /* Show the icon on hover */
}

.locked-button::before {
    content: ''; /* Initially empty */
    position: relative;
    top: 50%;
    transform: translateY(-50%);
    font-family: 'Font Awesome 5 Free'; /* Font Awesome family */
    font-weight: 900; /* Solid icon */
    color: white; /* Icon color */
    display: none; /* Hidden by default */
    font-size: 10px; /* Default icon size */
}

.locked-button:hover::before {
    content: '\f023'; /* Unicode for the lock icon (Font Awesome) */
    display: block; /* Show the icon on hover */
    color: black; /* Change icon color to black on hover */
    font-size: 40px; /* Set desired icon size on hover */
    padding: 0%;
}

.locked-slider:hover object,
.locked-button:hover i {
    display: none; /* Hide the original icon on hover */
}

.locked-slider:hover i {
    display: inline; /* Show the icon on hover */
}

.locked-slider::before {
  content: ''; 
    position: absolute;
    top: 24px;
    left: 50%; /* Center horizontally relative to the parent */
    transform: translateX(-50%) translateY(-50%); /* Adjust position to center */
    font-family: 'Font Awesome 5 Free'; 
    font-weight: 900; 
    color: white; 
    display: none;
    font-size: 10px;
    z-index: 1000;
}

.locked-slider {
    position: relative; /* Set the parent as relative */
   
}


.locked-slider:hover::before {
    content: '\f023'; /* Unicode for the lock icon (Font Awesome) */
    display: block; /* Show the icon on hover */
    color: black; /* Change icon color to black on hover */
    font-size: 40px; /* Set desired icon size on hover */
    padding: 0%;
}

  </style>
</head>
<body>
  
</button>
  <div class="side-bar">
    
    <button class="close-button" onclick="closeSidebar()"><i class="fa-solid fa-x" style="color: #000000;"></i>
    </button>
    <div class="container">
      
      <div id="save" class="log">
        
        <div class="about text-dark-mode"><object class="paper-logo" type="image/svg+xml" data="imgs/newspaper-regular.svg" width="20" height="20">Summarizer</object></i><span class="paper-logo-text style="color: #252525;">Summarizer</span></div>
        <h2 class="History">Saved articles:</h2>
          <select id="sortOptions">
              <option value="default">Sort By</option>
              <option value="Alphabetical">Alphabetical</option>
              <option value="chronological">Recent</option>
          </select>
          <ul class="saved-text-list"></ul>
          <button class="side-bar-btns" id="clearLogsButton">Delete saved articles</button>
          <a href="http://localhost:3000/">
            <button class="side-bar-btns">Logout</button>
        </a>
      </div>
  </div>
  </div>
 <!--<div class="header header-dark" id="header">
  <div class="logo">--> 
    <button class="open-button" onclick="togglePopup()">Open Menu</button>
  </object>
  <i class="fas fa-lock" style="display: none;"></i>
 </button>
  </div>
</div>
<div class="options-bar">
  <button class="option-btn save-btn locked-button"><object type="image/svg+xml" data="imgs\download-solid.svg" width="20" height="20"></object><br>Save</button>
  <button class="option-btn locked-button" onclick="speakText()"><object type="image/svg+xml" data="imgs/play-solid.svg" width="20" height="20"></object><br>Speak</button>
  <button class="option-btn locked-button" onclick="copyToClipboard()"><object type="image/svg+xml" data="imgs/copy-solid.svg" width="20" height="20"></object><br>Copy</button>
  <button class="option-btn locked-button" onclick="repeatLastMessage()"><object type="image/svg+xml" data="imgs/repeat-solid.svg" width="20" height="20"></object><br>Redo</button>
</div>
<div class="slider-container locked-slider">
  <input type="range" min="1" max="3" value="2" class="slider" id="mySlider" step="1" oninput="updateSliderValue()">
  <p style="margin: 10px; margin-top: 16px;">Summary length: <span id="sliderValue">Medium</span></p>
</div>
<div class="chat-container chat-dark-mode">
  <div class="chat-log" id="chat-log"></div>
  <div class="input-container input-container-dark" id="input-container">
    <input type="text" class="user-input user-input-dark" id="user-input" placeholder="Enter URL..." />
    <button class="paste-btn" onclick="pasteClipboard()">Paste</button>
    <button class="send-btn" onclick="sendMessage()">Summarize</button>
  </div>
  <div class="footer">Created by <span style="color: #216d21;">Will Ratkowski</span>, powered by Groq AI.</div>
</div>
  
  <button class="theme-tog" onclick="myFunction()" width="20" height="20"></button>
  <!--lock icon-->
  <i class="fas fa-lock" style="display: none;"></i>

  <script>
    let lastMessage = ""; // Variable to store the last message sent by the user
    let sliderValue = 2; // Initialize the slider value

    async function sendMessage() {
  const input = document.getElementById("user-input");
  const message = input.value;
  if (!message) return;

  const chatLog = document.getElementById("chat-log");
  chatLog.innerHTML = '';

  // Add user's message to chat log
  chatLog.innerHTML += `<div class="message user-message"><span class="link-text">Your link</span>: ${message}</div>`;
  lastMessage = message; // Store the last message
  input.value = "";
  chatLog.scrollTop = chatLog.scrollHeight; // Scroll to bottom

  // Send message to backend
  try {
    const response = await fetch("/api/chat", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify({ message }),
    });
    const data = await response.json();

    // Add AI's response to chat log
    chatLog.innerHTML += `
  <div class="text-input message ai-message" id="textToRead">
    <span class="ai-text">Summarized:</span> ${data.response.replace(/\n/g, '<br>')}
  </div>
`;
    chatLog.scrollTop = chatLog.scrollHeight; // Scroll to bottom

    

    // Show the copy button
    document.getElementById("ai-response-container").style.display = "block"; // Display the copy button
  } catch (error) {
    console.error("Error:", error);
    chatLog.innerHTML += `<div class="message ai-message"></div>`;
    chatLog.scrollTop = chatLog.scrollHeight; // Scroll to bottom
    document.getElementById("ai-response-container").style.display = "none"; // Hide the copy button
  }
}


function repeatLastMessage() {
  if (lastMessage) {
    document.getElementById("user-input").value = lastMessage; // Set the input value to the last message
    sendMessage(); // Call sendMessage to send the last message
  } else {
    alert("No message to repeat.");
  }
}


// theme toggle
function myFunction() {
    var bodyElement = document.body;
    var chatContainer = document.querySelector('.chat-container');
    const about = document.querySelector(".about");
    const header = document.getElementById("header");
    const inputContainer = document.getElementById("input-container");
    const userInput = document.getElementById("user-input");

    // Toggle dark mode class on body
    bodyElement.classList.toggle("dark-mode");
    header.classList.toggle("header-dark");
    
    // Toggle chat dark mode class on chat container
    chatContainer.classList.toggle("chat-dark-mode");
    inputContainer.classList.toggle("input-container-dark");
    userInput.classList.toggle("user-input-dark")

    about.classList.toggle("text-dark-mode");
  }

  function speakText() {
  const textElement = document.getElementById("textToRead");

  // Make sure the element exists and has content
  if (textElement) {
    const text = textElement.textContent; // Use textContent to get the text inside the div
    
    // Check if the browser supports SpeechSynthesis
    if ('speechSynthesis' in window) {
      const utterance = new SpeechSynthesisUtterance(text);
      speechSynthesis.speak(utterance);
    } else {
      alert("Sorry, your browser doesn't support text-to-speech.");
    }
  } else {
    alert("No text found to read aloud.");
  }
}
// Add this function to your existing script
function copyToClipboard() {
  const aiResponse = document.querySelector("#textToRead");

  // Make sure the AI response element exists
  if (aiResponse) {
    const responseText = aiResponse.textContent;

    // Use the clipboard API to copy the text
    navigator.clipboard.writeText(responseText).then(() => {
      
    }).catch(err => {
      console.error("Could not copy text: ", err);
    });
  } else {
    
  }
}

document.querySelector('.save-btn').addEventListener('click', function() {
  // Get the AI response text
  const aiResponseElement = document.querySelector('#textToRead');
  
  if (aiResponseElement) {
    const inputText = aiResponseElement.textContent.trim();
    
    // Check if there's any text to save
    if (inputText) {
      // Create a new list item
      const listItem = document.createElement('li');
      listItem.textContent = inputText;
      
      // Append the list item to the sidebar list
      document.querySelector('.saved-text-list').appendChild(listItem);
    } else {
      alert('No text available to save!');
    }
  } else {
    alert('AI response not found!');
  }
});

//side-bar btn

function togglePopup() {
  const container = document.querySelector('.side-bar');
  container.style.display = container.style.display === 'block' ? 'none' : 'block';
}

function closeSidebar() {
  const sidebar = document.querySelector('.side-bar');
  sidebar.style.display = 'none';
}
  </script>

<script src="js/sliderscript.js"></script> <!-- Slider JS -->
<script src="js/copyscript.js"></script> <!-- Copy JS -->
<script src="js/loginScript.js"></script> <!-- Login JS -->
<script src="Hover lock/hoverlock.js"></script> <!-- hover lock JS -->

</body>
</html>
